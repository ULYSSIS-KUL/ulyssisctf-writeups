# recycling writeup

This challenge is a variant on the [Vigenère cipher](https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher). It's a simple substition cipher, except not every character uses the same substitution alphabet. The alphabet varies per character according to an encryption key. In this challenge, the ciphertext is acquired by XOR-ing the plaintext with the key character per character (byte per byte). However, this key is not as long as the plaintext, so there's still reuse of the key, so frequency analysis is still possible!

However, to perform frequency analysis, you need to know how long the key is. There is a way to find this from only the ciphertext, using the [index of coincidence](https://en.wikipedia.org/wiki/Index_of_coincidence). This method tests how 'random' the distribution of characters is for a given key length, so the 'least random' key length is a good candidate. Of course, you could also just assume that the flag is the key, in which case you simply know that the length is 49 characters.

Knowing the key length, you simply have to perform [frequency analysis](https://en.wikipedia.org/wiki/Frequency_analysis) for each character of the key separately. This lets you decrypt the text (*Flatland*, a story about a two-dimensional world intended to illustrate what higher dimensions might be like). But the text does not contain the flag, this flag is the key. Because of the nice properties of XOR, you simply need to XOR the plaintext and ciphertext together to obtain the flag. Or, instead of decrypting the entire text, you can directly determine the flag by knowing that the most common character in an English text is the space character, so you can simply XOR the most common character in every 'slice' of the ciphertext with the space character to directly obtain the corresponding character from the flag.

Another method to breaking the Vigenère cipher is possible, using a [heuristic search method](http://practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-vigenere-cipher-part-2/). You start with an empty key and select the next character in the key depending on which one gives you the 'most English-like' text.

