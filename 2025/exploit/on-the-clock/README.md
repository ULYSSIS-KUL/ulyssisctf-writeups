# on-the-clock writeup

> This is a race, but for being the slowest. Can you win it?

> Welcome, participant. In this challenge, you will have to figure out the
> correct flag entirely on your own. We can only tell you whether you have the
> right flag or not.
>
> But, fret not! You can find this flag by being as slow as possible to do so.
> So grab a stopwatch, aaaand, Ready, Set, Go!
>
> You may need to perform a number of automated HTTP queries, this is intended.
> However, not much more than 700 queries need to be made when solving the
> challenge.

We are presented with a webpage that asks us for a flag, and tells us whether
it is correct. There seems to be no way to find a solution by giving incorrect
input.

However, the flavortext gives a hint: maybe there's something with timing going
on? Let's use `time(1)` on `curl` to time a few HTTP requests (supposing the
solution is `FLG{abc}`):

```
# attempt = FLG{ccc}
$ time curl 'http://192.168.0.108:8088/check?flag=FLG%7Bccc%7D'
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>Redirecting...</title>
<h1>Redirecting...</h1>
<p>You should be redirected automatically to target URL: <a href="/?response=Wrong%3A+flag+does+not+match+the+correct+one.">/?response=Wrong%3A+flag+does+not+match+the+correct+one.</a>. If not click the link.
real	0m0,005s
user	0m0,000s
sys	0m0,004s
```

```
# attempt = FLG{acc}
$ time curl 'http://192.168.0.108:8088/check?flag=FLG%7Bacc%7D'
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>Redirecting...</title>
<h1>Redirecting...</h1>
<p>You should be redirected automatically to target URL: <a href="/?response=Wrong%3A+flag+does+not+match+the+correct+one.">/?response=Wrong%3A+flag+does+not+match+the+correct+one.</a>. If not click the link.
real	0m0,042s
user	0m0,002s
sys	0m0,003s
```

```
# attempt = FLG{abd}
$ time curl 'http://192.168.0.108:8088/check?flag=FLG%7Babd%7D'
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>Redirecting...</title>
<h1>Redirecting...</h1>
<p>You should be redirected automatically to target URL: <a href="/?response=Wrong%3A+flag+does+not+match+the+correct+one.">/?response=Wrong%3A+flag+does+not+match+the+correct+one.</a>. If not click the link.
real	0m0,076s
user	0m0,003s
sys	0m0,001s
```

There seems to be a difference in timing depending on how many starting
characters are correct. This is a simple timing side-channel! So, instead of
having to try all possibilities, it's possible to figure out the flag
character-by-character. So, only `16*44 ~= 700` attempts at worst (average
`16*44/2`) need to be made, instead of `16^44`.

This challenge used to be named differently, before it was renamed to give a
bigger hint. The *Kanaal Dessel-Kwaadmechelen* is a canal ('*kanaal*' in Dutch
can mean both *canal* and *channel*) that branches off from the large
*Albertkanaal*. Therefore, it is a "side channel". Haa haa, hee hee, and
furthermore, hoo hoo.
